<!DOCTYPE html>
<html lang="mn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>urtuuch.mn</title>
    <link href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* –¢–ê–ù–´ CSS */
        body { font-family:'Ubuntu',sans-serif; margin:0; padding:0; background:#f0f5f5; color:#333; }
        header{ background:#fff; padding:10px 15px; position:sticky; top:0; box-shadow:0 2px 10px rgba(0,0,0,0.1); z-index:100; display:flex; flex-direction:column;}
        header h1{margin:0; font-size:22px;}
        .search-box input{width:100%; padding:8px 12px; border-radius:8px; border:1px solid #ccc; margin:10px 0; font-size:14px; box-sizing:border-box;}
        nav {background:#3d85c6; display:flex; flex-wrap:wrap; padding:10px;}
        nav ul {list-style:none; margin:0; padding:0; display:flex; flex-wrap:wrap;}
        nav ul li {position:relative; margin-right:20px;}
        nav ul li a {color:#fff; text-decoration:none; padding:8px 12px; display:block; font-weight:bold; border-radius:6px;}
        nav ul li:hover > a {background:#6fa8dc;}
        nav ul li ul {display:none; position:absolute; top:100%; left:0; background:#6fa8dc; list-style:none; padding:0; margin:0; border-radius:6px; min-width:180px; z-index:100;}
        nav ul li:hover ul {display:block;}
        nav ul li ul li a {padding:8px 12px; color:#fff; text-decoration:none; display:block;}
        nav ul li ul li a:hover {background:#3d85c6;}
        
        /* --------------------------------------------------- */
        /* –®–ò–ù–≠–ß–ò–õ–°–≠–ù GRID, FEATURED CARD-–´–ù –¢–û–•–ò–†–ì–û–û */
        /* --------------------------------------------------- */
        .grid{
            display:grid; 
            grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); 
            gap:15px; 
            padding:15px;
        }
        
        .card{cursor:pointer; border-radius:12px; overflow:hidden; box-shadow:0 4px 15px rgba(0,0,0,0.1); position:relative; transition: transform 0.3s, box-shadow 0.3s; background:#fff;}
        .card:hover{transform:translateY(-5px) scale(1.03); box-shadow:0 8px 25px rgba(0,0,0,0.2);}
        .card img{width:100%; height:150px; object-fit:cover;}
        .card-content{padding:10px; position:relative;}
        .card-title{font-size:16px; margin:0; font-weight:bold;}
        .card-meta{font-size:12px; color:#666; margin-top:5px; display:flex; justify-content:space-between; flex-wrap:wrap;}
        .card-meta span.category{background:#6fa8dc; color:#fff; padding:2px 8px; border-radius:6px; font-size:12px;}
        .card-author{display:flex; align-items:center; gap:5px; margin-top:8px;}
        .card-author img{width:25px; height:25px; border-radius:50%; object-fit:cover;}
        
        /* –•—É—É—á–∏–Ω featured-card —Ç–æ—Ö–∏—Ä–≥–æ–æ–≥ –∞—Ä–∏–ª–≥–∞–∂, —à–∏–Ω—ç –∑–∞–≥–≤–∞—Ä—Ç —Ç–æ—Ö–∏—Ä—É—É–ª–∂ –±–∞–π–Ω–∞ */
        .featured-card {
            grid-column: span 2; /* 2 –±–∞–≥–∞–Ω–∞ —ç–∑—ç–ª–Ω—ç */
            display: flex; 
            box-shadow: 0 6px 20px rgba(0,0,0,0.2); 
            border: 2px solid #3d85c6; /* –¢–æ–¥—Ä—É—É–ª—Å–∞–Ω —Ö“Ø—Ä—ç—ç */
        }
        .featured-card img{
            width: 50%; /* –ó—É—Ä–≥–∏–π–≥ —Ç–∞–ª —Ö—É–≤—å –±–æ–ª–≥–æ–Ω–æ */
            height: auto; 
            object-fit: cover;
            min-height: 250px; /* –û–Ω—Ü–ª–æ—Ö –º—ç–¥—ç—ç–Ω–∏–π ”©–Ω–¥—Ä–∏–π–≥ —Ç–æ–≥—Ç–æ–æ–Ω–æ */
        } 
        .featured-card .card-content{
            width: 50%; /* –¢–µ–∫—Å—Ç–∏–π–≥ —Ç–∞–ª —Ö—É–≤—å –±–æ–ª–≥–æ–Ω–æ */
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 20px;
        }
        .featured-card .card-title {
            font-size: 24px; /* –¢–æ–º—Ä—É—É–ª—Å–∞–Ω –≥–∞—Ä—á–∏–≥ */
            font-weight: 700;
        }
        .featured-card .card-meta span.category{
            background: #d9534f; /* –£–ª–∞–∞–Ω ”©–Ω–≥”©”©—Ä –æ–Ω—Ü–ª–æ—Ö */
            font-size: 14px;
        }
        
        /* –ë—É—Å–∞–¥ –∑–∞–≥–≤–∞—Ä—É—É–¥ */
        .card-desc-preview{display:none; position:absolute; top:0; left:0; width:100%; height:100%; background:rgba(255,255,255,0.95); padding:12px; font-size:13px; line-height:1.4; border-radius:12px; overflow:auto; z-index:10;}
        .card:hover .card-desc-preview{display:block;}¬†
        .video-card{grid-column:1/-1; padding:0; margin-bottom:20px;}
        .video-card iframe{width:100%; height:300px; border:none; border-radius:12px;}
        .authors-container {display:flex; gap:10px; padding:10px; justify-content:center; flex-wrap:wrap; background:#fff; border-radius:12px; box-shadow:0 2px 10px rgba(0,0,0,0.1);}
        .author-card {flex:1 1 80px; max-width:120px; text-align:center; padding:5px; border-radius:8px; background:#fff; box-shadow:0 2px 10px rgba(0,0,0,0.15);}
        .author-card img {width:50px; height:50px; border-radius:50%; margin-bottom:5px;}
        .author-name{font-weight:bold; font-size:14px;}
        .author-title{font-size:12px; color:#555;}
        .pagination{display:flex; justify-content:center; gap:5px; margin:10px 0; flex-wrap:wrap;}
        .pagination button{padding:5px 10px; border-radius:5px; border:none; background:#6fa8dc; color:#fff; cursor:pointer; transition:0.3s;}
        .pagination button:hover{background:#3d85c6;}
        .contact{background:#fff; padding:15px 10px; text-align:center; margin:15px; border-radius:12px; box-shadow:0 4px 10px rgba(0,0,0,0.1);}
        
        /* Modal */
        #newsModal {display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); justify-content:center; align-items:center; z-index:1000;}
        #newsModalContent {background:#fff; border-radius:12px; max-width:600px; width:90%; max-height:80%; overflow:auto; padding:15px; position:relative;}
        #newsModalClose {position:absolute; top:10px; right:15px; cursor:pointer; font-weight:bold; font-size:18px;}
        #newsModalContent img{width:100%; max-height:200px; object-fit:cover; border-radius:8px; margin-bottom:10px;}
        
        @media(max-width:768px){
            .grid{grid-template-columns:1fr; gap:10px; padding:10px;}
            .video-card iframe{height:200px;}
            header h1{font-size:18px;}
            .search-box input{font-size:12px;}
            nav ul{flex-direction:column;}
            nav ul li{margin-right:0; margin-bottom:5px;}
            nav ul li ul {position:relative; top:0;}
            
            /* Featured card-–≥ –≥–∞—Ä —É—Ç–∞—Å–Ω—ã —Ö—É–≤—å–¥ –Ω—ç–≥ –±–∞–≥–∞–Ω–∞ –±–æ–ª–≥–æ–∂, –∑—É—Ä–≥–∏–π–≥ –¥—ç—ç–¥ —Ç–∞–ª–¥ –≥–∞—Ä–≥–∞–Ω–∞ */
            .featured-card{grid-column:1/-1; flex-direction:column;} 
            .featured-card img{width:100%; height:200px; min-height: 150px;}
            .featured-card .card-content{width:100%;}
        }
    </style>
</head>
<body>
<header>
    <h1>urtuuch.mn</h1>
    <div class="search-box"><input type="text" placeholder="–•–∞–π—Ö —É—Ç–≥–∞ –æ—Ä—É—É–ª–Ω–∞ —É—É!" id="searchInput"></div>
    <nav>
        <ul>
            <li><a href="#">–£–ª—Å —Ç”©—Ä</a>
                <ul>
                    <li><a href="#">–¢–æ–π–º</a></li>
                    <li><a href="#">–ù–∏–π—Ç–ª—ç–ª</a></li>
                    <li><a href="#">–°—É—Ä–≤–∞–ª–∂–∏–ª–≥–∞</a></li>
                    <li><a href="#">”®—Ä—Ç”©”©—á–∏–π–Ω “Ø–≥</a></li>
                    <li><a href="#">–•–æ–≤ –±–æ–ª–æ—Ö –≤–∏–π</a></li>
                </ul>
            </li>
            <li><a href="#">–≠–¥–∏–π–Ω –∑–∞—Å–∞–≥</a>
                <ul>
                    <li><a href="#">–£—É–ª —É—É—Ä—Ö–∞–π</a></li>
                    <li><a href="#">–î—ç–¥ –±“Ø—Ç—ç—Ü</a></li>
                    <li><a href="#">–ú–æ–Ω–≥–æ–ª–¥ “Ø–π–ª–¥–≤—ç—Ä–ª—ç–≤</a></li>
                    <li><a href="#">–ó–∞—Ä —Å—É—Ä—Ç–∞–ª—á–∏–ª–≥–∞–∞</a></li>
                </ul>
            </li>
            <li><a href="#">–°–æ—ë–ª —É—Ä–ª–∞–≥</a>
                <ul>
                    <li><a href="#">–Ø—Ä–∏–ª—Ü–ª–∞–≥–∞</a></li>
                    <li><a href="#">–°—É—Ä–≤–∞–ª–∂–∏–ª–≥–∞</a></li>
                    <li><a href="#">–ö–∏–Ω–æ –µ—Ä—Ç”©–Ω—Ü</a></li>
                    <li><a href="#">–£—Ç–≥–∞ –∑–æ—Ö–∏–æ–ª</a></li>
                    <li><a href="#">–°–æ—ë–ª —Å—É–¥–ª–∞–ª</a></li>
                </ul>
            </li>
            <li><a href="#">–ú–µ–¥–∏–∞</a>
                <ul>
                    <li><a href="#">–ù—ç–≤—Ç—Ä“Ø“Ø–ª—ç–≥</a></li>
                    <li><a href="#">–ú—ç–¥—ç—ç</a></li>
                    <li><a href="#">–°—É—Ä–≤–∞–ª–∂–∏–ª–≥–∞</a></li>
                    <li><a href="#">MIC UP</a></li>
                    <li><a href="#">–ó—É—Ä–∞–≥–ª–∞–ª</a></li>
                    <li><a href="#">”®—Ä—Ç”©”©—á”©”©—Å</a></li>
                </ul>
            </li>
            <li><a href="#">–î—ç–ª—Ö–∏–π –¥–∞—Ö–∏–Ω–¥</a>
                <ul>
                    <li><a href="#">–£–ª—Å —Ç”©—Ä</a></li>
                    <li><a href="#">–¢–∞–Ω–∏–Ω –º—ç–¥—ç—Ö“Ø–π</a></li>
                    <li><a href="#">–®–∏–Ω–∂–ª—ç—Ö —É—Ö–∞–∞–Ω</a></li>
                </ul>
            </li>
            <li><a href="#">–Ø—Ä–∏–ª—Ü–ª–∞–≥–∞</a>
                <ul>
                    <li><a href="#">–•”©—Ä”©–≥ —è—Ä–∏–ª—Ü–ª–∞–≥–∞</a></li>
                    <li><a href="#">–£–ª—Å —Ç”©—Ä–∏–π–Ω —è—Ä–∏–ª—Ü–ª–∞–≥–∞</a></li>
                </ul>
            </li>
        </ul>
    </nav>
</header>

<div class="grid" id="newsContainer"></div>
<div class="video-card" id="videoContainer">
    <iframe src="https://www.youtube.com/embed/dQw4w9WgXcQ" allowfullscreen></iframe>
</div>
<div class="authors-container" id="authorsContainer"></div>
<div class="pagination" id="pagination"></div>

<div class="contact">
    <h3>–•–æ–ª–±–æ–æ –±–∞—Ä–∏—Ö</h3>
    <p>–£—Ç–∞—Å: 94344777</p>
    <p>Face: urtuuch.mn</p>
    <p>–•–∞—è–≥: –ê—Ä–≤–∞–π—Ö—ç—ç—Ä —Ö–æ—Ç</p>
</div>

<div id="newsModal">
    <div id="newsModalContent">
        <span id="newsModalClose">&times;</span>
        <h2 id="modalTitle"></h2>
        <div id="modalMeta" style="color:#666; font-size:12px; margin-bottom:10px;"></div>
        <img id="modalImage" src="">
        <div id="modalContent"></div>
    </div>
</div>

<script type="module">
// Supabase-–∏–π–Ω JS –∏–º–ø–æ—Ä—Ç
import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.42.0/+esm';

const SUPABASE_URL = "https://wpotnvekaoosdkvmhqgo.supabase.co";
const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Indwb3RudmVrYW9vc2Rrdm1ocWdvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjUwMTU3NjQsImV4cCI6MjA4MDU5MTc2NH0.YIpy_IA9nNseYUJB3Y-adxgv9btgAt5IKP5FJpafNC0";

const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

let authorsData = [];
let newsData = [];
let currentPage = 1;
// NEWS_PER_PAGE-–∏–π–≥ 29 –±–æ–ª–≥–æ—Ö –Ω—å —É—Ä—Ç —Ö—É–≥–∞—Ü–∞–∞–Ω–¥ —Ç–æ—Ö–∏—Ä–æ–º–∂–≥“Ø–π —Ç—É–ª, –±–∏–¥ pagination-–∏–π–≥ —Ö—ç–≤—ç—ç—Ä “Ø–ª–¥—ç—ç–∂, –Ω–∏–π—Ç –º—ç–¥—ç—ç–Ω–∏–π —Ç–æ–æ–≥ —Ö—è–∑–≥–∞–∞—Ä–ª–∞—è.
const NEWS_PER_PAGE = 12; 
const TOTAL_NEWS_LIMIT = 29; // –ù—ç–≥ —Ö—É—É–¥—Å–∞–Ω–¥ —Ç–∞—Ç–∞—Ö –Ω–∏–π—Ç –º—ç–¥—ç—ç–Ω–∏–π —Ç–æ–æ (–¢–∞–Ω—ã —Ö“Ø—Å—ç–ª—Ç—ç—ç—Ä 29)

async function fetchAuthors() {
    const { data, error } = await supabase.from('authors').select('*').order('id');
    if(error) console.error("Authors fetch error:", error); 
    else authorsData = data;
}

async function fetchNews() {
    // üîî 29 –ú–≠–î–≠–≠–ì –¢–ê–¢–ê–• –õ–û–ì–ò–ö üîî
    const { data, error } = await supabase.from('news')
        .select('*')
        .eq('active', true) 
        // –≠—Ö–ª—ç—ç–¥ featured-—ç—ç—Ä (true) –¥–∞—Ä–∞–∞ –Ω—å –æ–≥–Ω–æ–æ–≥–æ–æ—Ä (—à–∏–Ω—ç—ç—Ä) —ç—Ä—ç–º–±—ç–ª–Ω—ç.
        .order('featured', { ascending: false }) 
        .order('created_at',{ascending:false})
        .limit(TOTAL_NEWS_LIMIT); // –•—è–∑–≥–∞–∞—Ä—ã–≥ 29 –±–æ–ª–≥–æ—Å–æ–Ω
        
    if(error) console.error("News fetch error:", error); 
    else newsData = data;
}

function displayAuthors() {
    const container = document.getElementById('authorsContainer');
    if (!authorsData || authorsData.length === 0) return; 

    container.innerHTML = authorsData.map(a=>`
        <div class="author-card">
            <img src="${a.image || 'https://i.imgur.com/KqJv6N6.png'}" alt="${a.name}">
            <div class="author-name">${a.name}</div>
            <div class="author-title">${a.title}</div>
        </div>
    `).join('');
}

function displayNews() {
    const container = document.getElementById('newsContainer');
    container.innerHTML = '';
    if (!newsData || newsData.length === 0) {
        container.innerHTML = '<p style="grid-column: 1 / -1; text-align: center; margin-top: 50px;">–û–¥–æ–æ–≥–æ–æ—Ä –Ω–∏–π—Ç–ª—ç–≥–¥—Å—ç–Ω –º—ç–¥—ç—ç –∞–ª–≥–∞ –±–∞–π–Ω–∞.</p>';
        renderPagination(0);
        return;
    }

    // Pagination –ª–æ–≥–∏–∫ (NewsData –Ω—å –æ–¥–æ–æ –Ω–∏–π—Ç 29 –º—ç–¥—ç—ç—Ç—ç–π –±–∞–π—Ö —ë—Å—Ç–æ–π)
    const start = (currentPage-1)*NEWS_PER_PAGE;
    const end = start + NEWS_PER_PAGE;
    const pageNews = newsData.slice(start,end);

    // Featured –º—ç–¥—ç—ç–≥ —è–ª–≥–∞—Ö. –ó”©–≤—Ö”©–Ω —ç—Ö–Ω–∏–π Featured –º—ç–¥—ç—ç–≥ —Ç–æ–º—Ä—É—É–ª–Ω–∞.
    let featuredItem = null;
    const itemsToDisplay = [];

    // –≠—Ö–Ω–∏–π featured –º—ç–¥—ç—ç–≥ —Ö–∞–π–∂ –æ–ª–æ—Ö
    for (const n of pageNews) {
        if (n.featured && !featuredItem) {
            featuredItem = n;
        } else {
            itemsToDisplay.push(n);
        }
    }
    
    // –•—ç—Ä—ç–≤ featured –º—ç–¥—ç—ç –æ–ª–¥—Å–æ–Ω –±–æ–ª —Ç“Ø“Ø–Ω–∏–π–≥ —Ö–∞–º–≥–∏–π–Ω —ç—Ö—ç–Ω–¥ –±–∞–π—Ä–ª—É—É–ª–Ω–∞
    if (featuredItem) {
        // Featured –º—ç–¥—ç—ç–≥ —Ö–∞–º–≥–∏–π–Ω —ç—Ö–Ω–∏–π card –±–æ–ª–≥–æ–∂ —Ö–∞—Ä—É—É–ª–Ω–∞
        const featuredDiv = createNewsCard(featuredItem, true);
        container.appendChild(featuredDiv);
    }
    
    // “Æ–ª–¥—Å—ç–Ω –º—ç–¥—ç—ç–≥ –µ—Ä–¥–∏–π–Ω card-–∞–∞—Ä —Ö–∞—Ä—É—É–ª–Ω–∞
    itemsToDisplay.forEach(n=>{
        const div = createNewsCard(n, false);
        container.appendChild(div);
    });

    renderPagination();
    displayAuthors();
}

/**
 * News Card “Ø“Ø—Å–≥—ç—Ö —Ç—É—Å–ª–∞—Ö —Ñ—É–Ω–∫—Ü
 * @param {Object} n - –ú—ç–¥—ç—ç–Ω–∏–π –æ–±—å–µ–∫—Ç
 * @param {boolean} isFeatured - –û–Ω—Ü–ª–æ—Ö –º—ç–¥—ç—ç —ç—Å—ç—Ö
 * @returns {HTMLElement} - Card div —ç–ª–µ–º–µ–Ω—Ç
 */
function createNewsCard(n, isFeatured) {
    const author = authorsData.find(a=>a.id===n.author_id) || {name:"–¢–æ–¥–æ—Ä—Ö–æ–π–≥“Ø–π",image:"https://i.imgur.com/KqJv6N6.png"};
    
    const div = document.createElement('div');
    div.className = isFeatured ? "card featured-card" : "card";
    
    const categorySpan = isFeatured ? 
        `<span class="category" style="background: #d9534f;">–û–ù–¶–õ–û–• | ${n.category}</span>` : 
        `<span class="category">${n.category}</span>`;
    
    const contentHtml = `
        <div class="card-content">
            <h3 class="card-title">${n.title}</h3>
            <div class="card-meta">${categorySpan}</div>
            <div class="card-author"><img src="${author.image}" alt="${author.name}"><span>${author.name}</span></div>
        </div>
    `;
    
    div.innerHTML = `${n.image?`<img src="${n.image}" alt="${n.title}">`:''}${contentHtml}`;

    div.addEventListener('click', ()=> {
        window.location.href = `news.html?slug=${n.slug}`;
    });
    return div;
}


function renderPagination() {
    const container = document.getElementById('pagination');
    // –ü–∞–≥–∏–Ω–∞—Ü–∏–π–≥ –Ω–∏–π—Ç —Ç–∞—Ç—Å–∞–Ω 29 –º—ç–¥—ç—ç–≥—ç—ç—Ä —Ç–æ–æ—Ü–Ω–æ
    const totalPages = Math.ceil(newsData.length/NEWS_PER_PAGE); 
    container.innerHTML='';
    if(totalPages<=1) return;

    if(currentPage>1){
        const prev=document.createElement('button');
        prev.innerText="”®–º–Ω”©—Ö";
        prev.onclick=()=>{currentPage--; displayNews();};
        container.appendChild(prev);
    }

    for(let i=1;i<=totalPages;i++){
        const btn=document.createElement('button');
        btn.innerText=i;
        if(i===currentPage) btn.style.background="#3d85c6";
        btn.onclick=()=>{currentPage=i; displayNews();};
        container.appendChild(btn);
    }

    if(currentPage<totalPages){
        const next=document.createElement('button');
        next.innerText="–î–∞—Ä–∞–∞—Ö";
        next.onclick=()=>{currentPage++; displayNews();};
        container.appendChild(next);
    }
}

function displayFilteredNews(filteredData) {
    const container = document.getElementById('newsContainer');
    container.innerHTML = '';
    
    document.getElementById('pagination').innerHTML = '';

    if (!filteredData || filteredData.length === 0) {
        container.innerHTML = '<p style="grid-column: 1 / -1; text-align: center; margin-top: 50px;">–•–∞–π–ª—Ç–∞–∞—Ä –º—ç–¥—ç—ç –æ–ª–¥—Å–æ–Ω–≥“Ø–π.</p>';
        return;
    }

    // –•–∞–π–ª—Ç–∞–∞—Ä –æ–ª–¥—Å–æ–Ω –º—ç–¥—ç—ç–Ω–∏–π “Ø–µ–¥ featured-–∏–π–≥ —Ç–æ–º—Ä—É—É–ª–∞—Ö —à–∞–∞—Ä–¥–ª–∞–≥–∞–≥“Ø–π (–µ—Ä–¥–∏–π–Ω card-–∞–∞—Ä —Ö–∞—Ä—É—É–ª–Ω–∞)
    filteredData.forEach(n => {
        const div = createNewsCard(n, false);
        container.appendChild(div);
    });
}

document.getElementById('searchInput').addEventListener('input', ()=>{
    const keyword = document.getElementById('searchInput').value.toLowerCase();
    
    const filtered = newsData.filter(n=>n.title.toLowerCase().includes(keyword));
    
    displayFilteredNews(filtered);

    if (keyword === '') {
        currentPage = 1;
        displayNews();
    }
});


// Modal close
document.getElementById('newsModalClose').onclick = ()=>{ document.getElementById('newsModal').style.display='none'; };
document.getElementById('newsModal').onclick = e=>{ if(e.target.id==='newsModal') document.getElementById('newsModal').style.display='none'; };

async function init(){
    await fetchAuthors();
    await fetchNews();
    displayNews();
}

init();

</script>
</body>
</html>
